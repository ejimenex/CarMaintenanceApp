<ion-app>
  <ion-menu id="main-menu" menuId="main-menu" contentId="main-content" type="overlay" class="simple-menu">
    <ion-header class="menu-header-bar">
      <ion-toolbar color="primary">
        <ion-title>CarClinic</ion-title>
      </ion-toolbar>
    </ion-header>

    <ion-content class="menu-content">
      <!-- User Info Section -->
      <div class="user-section">
        <div class="user-avatar">
          <ion-icon name="person-circle"></ion-icon>
        </div>
        <div class="user-details">
          <h3 class="user-name">{{ userName }}</h3>
          <p class="user-subtitle">{{ 'dashboard_menu_header_subtitle' | translate }}</p>
        </div>
      </div>

      <!-- Notifications Badge -->
      @if (unreadNotifications > 0) {
        <div class="notification-alert" (click)="navigateToNotifications()">
          <ion-icon name="notifications" class="notif-icon"></ion-icon>
          <span class="notif-text">{{ 'dashboard_menu_notifications_title' | translate }}</span>
          <ion-badge color="danger">{{ unreadNotifications }}</ion-badge>
        </div>
      }

      <!-- Login Stats -->
      @if (loginStats && !isLoadingStats) {
        <div class="stats-section">
          <div class="stat-row">
            <ion-icon name="time"></ion-icon>
            <span class="stat-label">{{ 'dashboard_menu_stats_lastAccess' | translate }}:</span>
            <span class="stat-value">{{ formatLastLogin(loginStats.lastLogin) }}</span>
          </div>
          <div class="stat-row">
            <ion-icon name="log-in"></ion-icon>
            <span class="stat-label">{{ 'dashboard_menu_stats_totalAccess' | translate }}:</span>
            <span class="stat-value">{{ loginStats.quantity }}</span>
          </div>
        </div>
      }

      @if (isLoadingStats) {
        <div class="stats-loading">
          <ion-spinner name="dots"></ion-spinner>
          <span>{{ 'dashboard_menu_stats_loading' | translate }}</span>
        </div>
      }

      <!-- Divider -->
      <div class="menu-divider"></div>

      <!-- Main Navigation List -->
      <ion-list class="menu-list">
        @for (page of menuPages; track page.url) {
          <ion-menu-toggle auto-hide="false">
            <ion-item 
              (click)="navigateTo(page.url)"
              lines="none" 
              detail="false" 
              class="menu-item"
              button>
              <ion-icon 
                slot="start" 
                [name]="page.icon"
                class="menu-icon">
              </ion-icon>
              <ion-label>{{ page.titleKey | translate }}</ion-label>
              @if (page.badge && page.badgeCount && page.badgeCount > 0) {
                <ion-badge color="danger" slot="end">{{ page.badgeCount }}</ion-badge>
              }
            </ion-item>
          </ion-menu-toggle>
        }

        <!-- Logout Option -->
        <ion-menu-toggle auto-hide="false">
          <ion-item 
            (click)="logout()"
            lines="none" 
            detail="false" 
            class="menu-item logout-item"
            button>
            <ion-icon 
              slot="start" 
              name="log-out"
              class="menu-icon">
            </ion-icon>
            <ion-label>{{ 'dashboard_menu_footer_logout' | translate }}</ion-label>
          </ion-item>
        </ion-menu-toggle>
      </ion-list>

      <!-- PRO Banner -->
      <div class="pro-banner" (click)="showProFeatures()">
        <div class="pro-badge">PRO</div>
        <div class="pro-text">{{ 'menu_go_pro' | translate }}</div>
      </div>
    </ion-content>
  </ion-menu>
  
  <ion-router-outlet id="main-content"></ion-router-outlet>
</ion-app>
